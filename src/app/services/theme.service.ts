import { Injectable, Inject, PLATFORM_ID } from "@angular/core";
import { isPlatformBrowser } from "@angular/common";
import { BehaviorSubject, Observable } from "rxjs";

export interface Theme {
  id: string;
  name: string;
  icon: string;
  isLight: boolean;
  primary: string;
  primaryDark: string;
  primaryLight: string;
  secondary: string;
  accent: string;
  background: string;
  backgroundAlt: string;
  surface: string;
  surfaceAlt: string;
  text: string;
  textMuted: string;
  border: string;
  gradient: string;
  gradientSecondary: string;
  headerBg: string;
  cardBg: string;
  inputBg: string;
  shadow: string;
}

@Injectable({
  providedIn: "root",
})
export class ThemeService {
  private isBrowser: boolean;
  private currentThemeSubject!: BehaviorSubject<Theme>;
  currentTheme$!: Observable<Theme>;

  readonly themes: Theme[] = [
    // ===== LIGHT THEMES (First in list) =====
    {
      id: "light-lavender",
      name: "Soft Lavender",
      icon: "üíú",
      isLight: true,
      primary: "#7c3aed",
      primaryDark: "#6d28d9",
      primaryLight: "#8b5cf6",
      secondary: "#ec4899",
      accent: "#06b6d4",
      background: "#faf5ff",
      backgroundAlt: "#f3e8ff",
      surface: "#e9d5ff",
      surfaceAlt: "#d8b4fe",
      text: "#3b0764",
      textMuted: "#6b7280",
      border: "#e9d5ff",
      gradient: "linear-gradient(135deg, #7c3aed 0%, #ec4899 100%)",
      gradientSecondary: "linear-gradient(135deg, #ec4899 0%, #7c3aed 100%)",
      headerBg: "rgba(250, 245, 255, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(124, 58, 237, 0.15)",
    },
    {
      id: "light-clean",
      name: "Clean White",
      icon: "‚òÄÔ∏è",
      isLight: true,
      primary: "#2563eb",
      primaryDark: "#1d4ed8",
      primaryLight: "#3b82f6",
      secondary: "#0891b2",
      accent: "#f59e0b",
      background: "#ffffff",
      backgroundAlt: "#f8fafc",
      surface: "#f1f5f9",
      surfaceAlt: "#e2e8f0",
      text: "#0f172a",
      textMuted: "#64748b",
      border: "#e2e8f0",
      gradient: "linear-gradient(135deg, #2563eb 0%, #0891b2 100%)",
      gradientSecondary: "linear-gradient(135deg, #0891b2 0%, #2563eb 100%)",
      headerBg: "rgba(255, 255, 255, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(37, 99, 235, 0.15)",
    },
    {
      id: "light-warm",
      name: "Warm Sand",
      icon: "üèñÔ∏è",
      isLight: true,
      primary: "#d97706",
      primaryDark: "#b45309",
      primaryLight: "#f59e0b",
      secondary: "#059669",
      accent: "#dc2626",
      background: "#fefce8",
      backgroundAlt: "#fef9c3",
      surface: "#fef3c7",
      surfaceAlt: "#fde68a",
      text: "#1c1917",
      textMuted: "#78716c",
      border: "#fde68a",
      gradient: "linear-gradient(135deg, #d97706 0%, #059669 100%)",
      gradientSecondary: "linear-gradient(135deg, #059669 0%, #d97706 100%)",
      headerBg: "rgba(254, 252, 232, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(217, 119, 6, 0.15)",
    },
    {
      id: "light-mint",
      name: "Fresh Mint",
      icon: "üçÉ",
      isLight: true,
      primary: "#059669",
      primaryDark: "#047857",
      primaryLight: "#10b981",
      secondary: "#0891b2",
      accent: "#7c3aed",
      background: "#ecfdf5",
      backgroundAlt: "#d1fae5",
      surface: "#a7f3d0",
      surfaceAlt: "#6ee7b7",
      text: "#064e3b",
      textMuted: "#4b5563",
      border: "#a7f3d0",
      gradient: "linear-gradient(135deg, #059669 0%, #0891b2 100%)",
      gradientSecondary: "linear-gradient(135deg, #0891b2 0%, #059669 100%)",
      headerBg: "rgba(236, 253, 245, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(5, 150, 105, 0.15)",
    },
    {
      id: "light-sky",
      name: "Sky Blue",
      icon: "üå§Ô∏è",
      isLight: true,
      primary: "#0284c7",
      primaryDark: "#0369a1",
      primaryLight: "#0ea5e9",
      secondary: "#8b5cf6",
      accent: "#f43f5e",
      background: "#f0f9ff",
      backgroundAlt: "#e0f2fe",
      surface: "#bae6fd",
      surfaceAlt: "#7dd3fc",
      text: "#0c4a6e",
      textMuted: "#64748b",
      border: "#bae6fd",
      gradient: "linear-gradient(135deg, #0284c7 0%, #8b5cf6 100%)",
      gradientSecondary: "linear-gradient(135deg, #8b5cf6 0%, #0284c7 100%)",
      headerBg: "rgba(240, 249, 255, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(2, 132, 199, 0.15)",
    },
    {
      id: "light-rose",
      name: "Rose Garden",
      icon: "üåπ",
      isLight: true,
      primary: "#e11d48",
      primaryDark: "#be123c",
      primaryLight: "#f43f5e",
      secondary: "#7c3aed",
      accent: "#0891b2",
      background: "#fff1f2",
      backgroundAlt: "#ffe4e6",
      surface: "#fecdd3",
      surfaceAlt: "#fda4af",
      text: "#4c0519",
      textMuted: "#6b7280",
      border: "#fecdd3",
      gradient: "linear-gradient(135deg, #e11d48 0%, #7c3aed 100%)",
      gradientSecondary: "linear-gradient(135deg, #7c3aed 0%, #e11d48 100%)",
      headerBg: "rgba(255, 241, 242, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(225, 29, 72, 0.15)",
    },
    {
      id: "light-peach",
      name: "Peach Cream",
      icon: "üçë",
      isLight: true,
      primary: "#ea580c",
      primaryDark: "#c2410c",
      primaryLight: "#f97316",
      secondary: "#d946ef",
      accent: "#0d9488",
      background: "#fff7ed",
      backgroundAlt: "#ffedd5",
      surface: "#fed7aa",
      surfaceAlt: "#fdba74",
      text: "#431407",
      textMuted: "#78716c",
      border: "#fed7aa",
      gradient: "linear-gradient(135deg, #ea580c 0%, #d946ef 100%)",
      gradientSecondary: "linear-gradient(135deg, #d946ef 0%, #ea580c 100%)",
      headerBg: "rgba(255, 247, 237, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(234, 88, 12, 0.15)",
    },
    {
      id: "light-coral",
      name: "Coral Reef",
      icon: "ü™∏",
      isLight: true,
      primary: "#f43f5e",
      primaryDark: "#e11d48",
      primaryLight: "#fb7185",
      secondary: "#14b8a6",
      accent: "#8b5cf6",
      background: "#fef2f2",
      backgroundAlt: "#fee2e2",
      surface: "#fecaca",
      surfaceAlt: "#fca5a5",
      text: "#450a0a",
      textMuted: "#6b7280",
      border: "#fecaca",
      gradient: "linear-gradient(135deg, #f43f5e 0%, #14b8a6 100%)",
      gradientSecondary: "linear-gradient(135deg, #14b8a6 0%, #f43f5e 100%)",
      headerBg: "rgba(254, 242, 242, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(244, 63, 94, 0.15)",
    },
    {
      id: "light-teal",
      name: "Teal Breeze",
      icon: "üåä",
      isLight: true,
      primary: "#0d9488",
      primaryDark: "#0f766e",
      primaryLight: "#14b8a6",
      secondary: "#8b5cf6",
      accent: "#f59e0b",
      background: "#f0fdfa",
      backgroundAlt: "#ccfbf1",
      surface: "#99f6e4",
      surfaceAlt: "#5eead4",
      text: "#134e4a",
      textMuted: "#64748b",
      border: "#99f6e4",
      gradient: "linear-gradient(135deg, #0d9488 0%, #8b5cf6 100%)",
      gradientSecondary: "linear-gradient(135deg, #8b5cf6 0%, #0d9488 100%)",
      headerBg: "rgba(240, 253, 250, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(13, 148, 136, 0.15)",
    },
    {
      id: "light-golden",
      name: "Golden Hour",
      icon: "üåÖ",
      isLight: true,
      primary: "#ca8a04",
      primaryDark: "#a16207",
      primaryLight: "#eab308",
      secondary: "#dc2626",
      accent: "#7c3aed",
      background: "#fefce8",
      backgroundAlt: "#fef9c3",
      surface: "#fef08a",
      surfaceAlt: "#fde047",
      text: "#422006",
      textMuted: "#78716c",
      border: "#fef08a",
      gradient: "linear-gradient(135deg, #ca8a04 0%, #dc2626 100%)",
      gradientSecondary: "linear-gradient(135deg, #dc2626 0%, #ca8a04 100%)",
      headerBg: "rgba(254, 252, 232, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(202, 138, 4, 0.15)",
    },
    {
      id: "light-lilac",
      name: "Lilac Dream",
      icon: "üíê",
      isLight: true,
      primary: "#a855f7",
      primaryDark: "#9333ea",
      primaryLight: "#c084fc",
      secondary: "#06b6d4",
      accent: "#f97316",
      background: "#faf5ff",
      backgroundAlt: "#f3e8ff",
      surface: "#e9d5ff",
      surfaceAlt: "#d8b4fe",
      text: "#581c87",
      textMuted: "#6b7280",
      border: "#e9d5ff",
      gradient: "linear-gradient(135deg, #a855f7 0%, #06b6d4 100%)",
      gradientSecondary: "linear-gradient(135deg, #06b6d4 0%, #a855f7 100%)",
      headerBg: "rgba(250, 245, 255, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(168, 85, 247, 0.15)",
    },
    {
      id: "light-sage",
      name: "Sage Green",
      icon: "üåø",
      isLight: true,
      primary: "#65a30d",
      primaryDark: "#4d7c0f",
      primaryLight: "#84cc16",
      secondary: "#0891b2",
      accent: "#e11d48",
      background: "#f7fee7",
      backgroundAlt: "#ecfccb",
      surface: "#d9f99d",
      surfaceAlt: "#bef264",
      text: "#1a2e05",
      textMuted: "#64748b",
      border: "#d9f99d",
      gradient: "linear-gradient(135deg, #65a30d 0%, #0891b2 100%)",
      gradientSecondary: "linear-gradient(135deg, #0891b2 0%, #65a30d 100%)",
      headerBg: "rgba(247, 254, 231, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(101, 163, 13, 0.15)",
    },
    {
      id: "light-ocean",
      name: "Ocean Mist",
      icon: "üåä",
      isLight: true,
      primary: "#0284c7",
      primaryDark: "#0369a1",
      primaryLight: "#0ea5e9",
      secondary: "#10b981",
      accent: "#f43f5e",
      background: "#f0f9ff",
      backgroundAlt: "#e0f2fe",
      surface: "#bae6fd",
      surfaceAlt: "#7dd3fc",
      text: "#0c4a6e",
      textMuted: "#475569",
      border: "#bae6fd",
      gradient: "linear-gradient(135deg, #0284c7 0%, #10b981 100%)",
      gradientSecondary: "linear-gradient(135deg, #10b981 0%, #0284c7 100%)",
      headerBg: "rgba(240, 249, 255, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(2, 132, 199, 0.15)",
    },
    {
      id: "light-fuchsia",
      name: "Fuchsia Bloom",
      icon: "üå∏",
      isLight: true,
      primary: "#c026d3",
      primaryDark: "#a21caf",
      primaryLight: "#d946ef",
      secondary: "#0d9488",
      accent: "#eab308",
      background: "#fdf4ff",
      backgroundAlt: "#fae8ff",
      surface: "#f5d0fe",
      surfaceAlt: "#e879f9",
      text: "#4a044e",
      textMuted: "#6b7280",
      border: "#f5d0fe",
      gradient: "linear-gradient(135deg, #c026d3 0%, #0d9488 100%)",
      gradientSecondary: "linear-gradient(135deg, #0d9488 0%, #c026d3 100%)",
      headerBg: "rgba(253, 244, 255, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(192, 38, 211, 0.15)",
    },
    {
      id: "light-slate",
      name: "Slate Gray",
      icon: "ü™®",
      isLight: true,
      primary: "#475569",
      primaryDark: "#334155",
      primaryLight: "#64748b",
      secondary: "#3b82f6",
      accent: "#f59e0b",
      background: "#f8fafc",
      backgroundAlt: "#f1f5f9",
      surface: "#e2e8f0",
      surfaceAlt: "#cbd5e1",
      text: "#0f172a",
      textMuted: "#64748b",
      border: "#e2e8f0",
      gradient: "linear-gradient(135deg, #475569 0%, #3b82f6 100%)",
      gradientSecondary: "linear-gradient(135deg, #3b82f6 0%, #475569 100%)",
      headerBg: "rgba(248, 250, 252, 0.95)",
      cardBg: "rgba(255, 255, 255, 0.9)",
      inputBg: "#ffffff",
      shadow: "rgba(71, 85, 105, 0.15)",
    },
    // ===== DARK THEMES =====
    {
      id: "ocean-blue",
      name: "Ocean Blue",
      icon: "üåä",
      isLight: false,
      primary: "#0066ff",
      primaryDark: "#0052cc",
      primaryLight: "#338aff",
      secondary: "#00d4aa",
      accent: "#ff6b35",
      background: "#0a0f1a",
      backgroundAlt: "#111827",
      surface: "#1a2235",
      surfaceAlt: "#252f45",
      text: "#ffffff",
      textMuted: "#94a3b8",
      border: "#334155",
      gradient: "linear-gradient(135deg, #0066ff 0%, #00d4aa 100%)",
      gradientSecondary: "linear-gradient(135deg, #00d4aa 0%, #0066ff 100%)",
      headerBg: "rgba(10, 15, 26, 0.95)",
      cardBg: "rgba(26, 34, 53, 0.8)",
      inputBg: "rgba(26, 34, 53, 0.6)",
      shadow: "rgba(0, 102, 255, 0.3)",
    },
    {
      id: "emerald-green",
      name: "Emerald Green",
      icon: "üíé",
      isLight: false,
      primary: "#10b981",
      primaryDark: "#059669",
      primaryLight: "#34d399",
      secondary: "#06b6d4",
      accent: "#f59e0b",
      background: "#0a1a14",
      backgroundAlt: "#10271e",
      surface: "#18352a",
      surfaceAlt: "#204538",
      text: "#ffffff",
      textMuted: "#94b8a8",
      border: "#305540",
      gradient: "linear-gradient(135deg, #10b981 0%, #06b6d4 100%)",
      gradientSecondary: "linear-gradient(135deg, #06b6d4 0%, #10b981 100%)",
      headerBg: "rgba(10, 26, 20, 0.95)",
      cardBg: "rgba(24, 53, 42, 0.8)",
      inputBg: "rgba(24, 53, 42, 0.6)",
      shadow: "rgba(16, 185, 129, 0.3)",
    },
    {
      id: "royal-purple",
      name: "Royal Purple",
      icon: "üëë",
      isLight: false,
      primary: "#8b5cf6",
      primaryDark: "#7c3aed",
      primaryLight: "#a78bfa",
      secondary: "#ec4899",
      accent: "#06b6d4",
      background: "#0f0a1a",
      backgroundAlt: "#180f27",
      surface: "#231835",
      surfaceAlt: "#302045",
      text: "#ffffff",
      textMuted: "#a894b8",
      border: "#403055",
      gradient: "linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%)",
      gradientSecondary: "linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%)",
      headerBg: "rgba(15, 10, 26, 0.95)",
      cardBg: "rgba(35, 24, 53, 0.8)",
      inputBg: "rgba(35, 24, 53, 0.6)",
      shadow: "rgba(139, 92, 246, 0.3)",
    },
    {
      id: "cyber-neon",
      name: "Cyber Neon",
      icon: "‚ö°",
      isLight: false,
      primary: "#00ffff",
      primaryDark: "#00cccc",
      primaryLight: "#66ffff",
      secondary: "#ff00ff",
      accent: "#ffff00",
      background: "#000011",
      backgroundAlt: "#0a0a22",
      surface: "#111133",
      surfaceAlt: "#1a1a44",
      text: "#ffffff",
      textMuted: "#8888aa",
      border: "#333366",
      gradient: "linear-gradient(135deg, #00ffff 0%, #ff00ff 100%)",
      gradientSecondary: "linear-gradient(135deg, #ff00ff 0%, #00ffff 100%)",
      headerBg: "rgba(0, 0, 17, 0.95)",
      cardBg: "rgba(17, 17, 51, 0.8)",
      inputBg: "rgba(17, 17, 51, 0.6)",
      shadow: "rgba(0, 255, 255, 0.3)",
    },
    {
      id: "midnight-dark",
      name: "Midnight Dark",
      icon: "üåô",
      isLight: false,
      primary: "#3b82f6",
      primaryDark: "#2563eb",
      primaryLight: "#60a5fa",
      secondary: "#64748b",
      accent: "#f472b6",
      background: "#030712",
      backgroundAlt: "#0a0f1c",
      surface: "#111827",
      surfaceAlt: "#1f2937",
      text: "#f8fafc",
      textMuted: "#64748b",
      border: "#1e293b",
      gradient: "linear-gradient(135deg, #3b82f6 0%, #64748b 100%)",
      gradientSecondary: "linear-gradient(135deg, #64748b 0%, #3b82f6 100%)",
      headerBg: "rgba(3, 7, 18, 0.95)",
      cardBg: "rgba(17, 24, 39, 0.8)",
      inputBg: "rgba(17, 24, 39, 0.6)",
      shadow: "rgba(59, 130, 246, 0.3)",
    },
    {
      id: "dark-crimson",
      name: "Crimson Night",
      icon: "üî•",
      isLight: false,
      primary: "#dc2626",
      primaryDark: "#b91c1c",
      primaryLight: "#ef4444",
      secondary: "#f59e0b",
      accent: "#06b6d4",
      background: "#1a0a0a",
      backgroundAlt: "#270f0f",
      surface: "#351818",
      surfaceAlt: "#452020",
      text: "#ffffff",
      textMuted: "#b89494",
      border: "#553030",
      gradient: "linear-gradient(135deg, #dc2626 0%, #f59e0b 100%)",
      gradientSecondary: "linear-gradient(135deg, #f59e0b 0%, #dc2626 100%)",
      headerBg: "rgba(26, 10, 10, 0.95)",
      cardBg: "rgba(53, 24, 24, 0.8)",
      inputBg: "rgba(53, 24, 24, 0.6)",
      shadow: "rgba(220, 38, 38, 0.3)",
    },
    {
      id: "dark-forest",
      name: "Forest Night",
      icon: "üå≤",
      isLight: false,
      primary: "#22c55e",
      primaryDark: "#16a34a",
      primaryLight: "#4ade80",
      secondary: "#14b8a6",
      accent: "#f472b6",
      background: "#0a1a0f",
      backgroundAlt: "#0f2718",
      surface: "#183520",
      surfaceAlt: "#204528",
      text: "#ffffff",
      textMuted: "#94b8a0",
      border: "#305538",
      gradient: "linear-gradient(135deg, #22c55e 0%, #14b8a6 100%)",
      gradientSecondary: "linear-gradient(135deg, #14b8a6 0%, #22c55e 100%)",
      headerBg: "rgba(10, 26, 15, 0.95)",
      cardBg: "rgba(24, 53, 32, 0.8)",
      inputBg: "rgba(24, 53, 32, 0.6)",
      shadow: "rgba(34, 197, 94, 0.3)",
    },
    {
      id: "dark-pink",
      name: "Pink Dusk",
      icon: "üå∏",
      isLight: false,
      primary: "#ec4899",
      primaryDark: "#db2777",
      primaryLight: "#f472b6",
      secondary: "#8b5cf6",
      accent: "#06b6d4",
      background: "#1a0a14",
      backgroundAlt: "#270f1e",
      surface: "#351828",
      surfaceAlt: "#452035",
      text: "#ffffff",
      textMuted: "#b894a8",
      border: "#553040",
      gradient: "linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%)",
      gradientSecondary: "linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%)",
      headerBg: "rgba(26, 10, 20, 0.95)",
      cardBg: "rgba(53, 24, 40, 0.8)",
      inputBg: "rgba(53, 24, 40, 0.6)",
      shadow: "rgba(236, 72, 153, 0.3)",
    },
    {
      id: "dark-orange",
      name: "Sunset Blaze",
      icon: "üåÖ",
      isLight: false,
      primary: "#f97316",
      primaryDark: "#ea580c",
      primaryLight: "#fb923c",
      secondary: "#eab308",
      accent: "#ec4899",
      background: "#1a0f0a",
      backgroundAlt: "#27180f",
      surface: "#352818",
      surfaceAlt: "#453520",
      text: "#ffffff",
      textMuted: "#b8a894",
      border: "#554430",
      gradient: "linear-gradient(135deg, #f97316 0%, #eab308 100%)",
      gradientSecondary: "linear-gradient(135deg, #eab308 0%, #f97316 100%)",
      headerBg: "rgba(26, 15, 10, 0.95)",
      cardBg: "rgba(53, 40, 24, 0.8)",
      inputBg: "rgba(53, 40, 24, 0.6)",
      shadow: "rgba(249, 115, 22, 0.3)",
    },
    {
      id: "dark-teal",
      name: "Teal Abyss",
      icon: "üê¨",
      isLight: false,
      primary: "#14b8a6",
      primaryDark: "#0d9488",
      primaryLight: "#2dd4bf",
      secondary: "#8b5cf6",
      accent: "#f59e0b",
      background: "#0a1a18",
      backgroundAlt: "#0f2725",
      surface: "#183532",
      surfaceAlt: "#204540",
      text: "#ffffff",
      textMuted: "#94b8b4",
      border: "#305550",
      gradient: "linear-gradient(135deg, #14b8a6 0%, #8b5cf6 100%)",
      gradientSecondary: "linear-gradient(135deg, #8b5cf6 0%, #14b8a6 100%)",
      headerBg: "rgba(10, 26, 24, 0.95)",
      cardBg: "rgba(24, 53, 50, 0.8)",
      inputBg: "rgba(24, 53, 50, 0.6)",
      shadow: "rgba(20, 184, 166, 0.3)",
    },
    {
      id: "dark-indigo",
      name: "Indigo Night",
      icon: "üîÆ",
      isLight: false,
      primary: "#6366f1",
      primaryDark: "#4f46e5",
      primaryLight: "#818cf8",
      secondary: "#06b6d4",
      accent: "#f43f5e",
      background: "#0a0a1a",
      backgroundAlt: "#0f0f27",
      surface: "#181835",
      surfaceAlt: "#202045",
      text: "#ffffff",
      textMuted: "#9494b8",
      border: "#303055",
      gradient: "linear-gradient(135deg, #6366f1 0%, #06b6d4 100%)",
      gradientSecondary: "linear-gradient(135deg, #06b6d4 0%, #6366f1 100%)",
      headerBg: "rgba(10, 10, 26, 0.95)",
      cardBg: "rgba(24, 24, 53, 0.8)",
      inputBg: "rgba(24, 24, 53, 0.6)",
      shadow: "rgba(99, 102, 241, 0.3)",
    },
    {
      id: "dark-gold",
      name: "Golden Night",
      icon: "‚ú®",
      isLight: false,
      primary: "#eab308",
      primaryDark: "#ca8a04",
      primaryLight: "#facc15",
      secondary: "#f97316",
      accent: "#8b5cf6",
      background: "#1a180a",
      backgroundAlt: "#27250f",
      surface: "#353218",
      surfaceAlt: "#454220",
      text: "#ffffff",
      textMuted: "#b8b494",
      border: "#555030",
      gradient: "linear-gradient(135deg, #eab308 0%, #f97316 100%)",
      gradientSecondary: "linear-gradient(135deg, #f97316 0%, #eab308 100%)",
      headerBg: "rgba(26, 24, 10, 0.95)",
      cardBg: "rgba(53, 50, 24, 0.8)",
      inputBg: "rgba(53, 50, 24, 0.6)",
      shadow: "rgba(234, 179, 8, 0.3)",
    },
    {
      id: "dark-slate",
      name: "Slate Shadow",
      icon: "üñ§",
      isLight: false,
      primary: "#64748b",
      primaryDark: "#475569",
      primaryLight: "#94a3b8",
      secondary: "#3b82f6",
      accent: "#f59e0b",
      background: "#0f1214",
      backgroundAlt: "#181c20",
      surface: "#1e242a",
      surfaceAlt: "#282f36",
      text: "#f1f5f9",
      textMuted: "#94a3b8",
      border: "#334155",
      gradient: "linear-gradient(135deg, #64748b 0%, #3b82f6 100%)",
      gradientSecondary: "linear-gradient(135deg, #3b82f6 0%, #64748b 100%)",
      headerBg: "rgba(15, 18, 20, 0.95)",
      cardBg: "rgba(30, 36, 42, 0.8)",
      inputBg: "rgba(30, 36, 42, 0.6)",
      shadow: "rgba(100, 116, 139, 0.3)",
    },
    {
      id: "dark-rose",
      name: "Rose Night",
      icon: "ü•Ä",
      isLight: false,
      primary: "#f43f5e",
      primaryDark: "#e11d48",
      primaryLight: "#fb7185",
      secondary: "#14b8a6",
      accent: "#eab308",
      background: "#1a0a0f",
      backgroundAlt: "#270f18",
      surface: "#351820",
      surfaceAlt: "#452028",
      text: "#ffffff",
      textMuted: "#b89498",
      border: "#553038",
      gradient: "linear-gradient(135deg, #f43f5e 0%, #14b8a6 100%)",
      gradientSecondary: "linear-gradient(135deg, #14b8a6 0%, #f43f5e 100%)",
      headerBg: "rgba(26, 10, 15, 0.95)",
      cardBg: "rgba(53, 24, 32, 0.8)",
      inputBg: "rgba(53, 24, 32, 0.6)",
      shadow: "rgba(244, 63, 94, 0.3)",
    },
    {
      id: "dark-charcoal",
      name: "Charcoal Noir",
      icon: "‚¨õ",
      isLight: false,
      primary: "#94a3b8",
      primaryDark: "#64748b",
      primaryLight: "#cbd5e1",
      secondary: "#8b5cf6",
      accent: "#22c55e",
      background: "#09090b",
      backgroundAlt: "#121215",
      surface: "#18181b",
      surfaceAlt: "#212124",
      text: "#fafafa",
      textMuted: "#71717a",
      border: "#27272a",
      gradient: "linear-gradient(135deg, #94a3b8 0%, #8b5cf6 100%)",
      gradientSecondary: "linear-gradient(135deg, #8b5cf6 0%, #94a3b8 100%)",
      headerBg: "rgba(9, 9, 11, 0.95)",
      cardBg: "rgba(24, 24, 27, 0.8)",
      inputBg: "rgba(24, 24, 27, 0.6)",
      shadow: "rgba(148, 163, 184, 0.2)",
    },
  ];

  constructor(@Inject(PLATFORM_ID) private platformId: Object) {
    this.isBrowser = isPlatformBrowser(platformId);

    // Initialize with Soft Lavender as default (first theme in array)
    this.currentThemeSubject = new BehaviorSubject<Theme>(this.themes[0]);
    this.currentTheme$ = this.currentThemeSubject.asObservable();

    if (this.isBrowser) {
      this.loadSavedTheme();
    }
  }

  getThemes(): Theme[] {
    return this.themes;
  }

  getDarkThemes(): Theme[] {
    return this.themes.filter((t) => !t.isLight);
  }

  getLightThemes(): Theme[] {
    return this.themes.filter((t) => t.isLight);
  }

  getCurrentTheme(): Theme {
    return this.currentThemeSubject.value;
  }

  setTheme(themeId: string): void {
    const theme = this.themes.find((t) => t.id === themeId);
    if (theme) {
      this.currentThemeSubject.next(theme);
      if (this.isBrowser) {
        this.applyTheme(theme);
        localStorage.setItem("selectedTheme", themeId);
      }
    }
  }

  private loadSavedTheme(): void {
    const savedThemeId = localStorage.getItem("selectedTheme");
    if (savedThemeId) {
      const theme = this.themes.find((t) => t.id === savedThemeId);
      if (theme) {
        this.currentThemeSubject.next(theme);
        this.applyTheme(theme);
      }
    } else {
      // Apply default theme (Soft Lavender - first theme)
      this.applyTheme(this.themes[0]);
    }
  }

  private applyTheme(theme: Theme): void {
    const root = document.documentElement;

    root.style.setProperty("--primary", theme.primary);
    root.style.setProperty("--primary-dark", theme.primaryDark);
    root.style.setProperty("--primary-light", theme.primaryLight);
    root.style.setProperty("--secondary", theme.secondary);
    root.style.setProperty("--accent", theme.accent);
    root.style.setProperty("--background", theme.background);
    root.style.setProperty("--background-alt", theme.backgroundAlt);
    root.style.setProperty("--surface", theme.surface);
    root.style.setProperty("--surface-alt", theme.surfaceAlt);
    root.style.setProperty("--text", theme.text);
    root.style.setProperty("--text-muted", theme.textMuted);
    root.style.setProperty("--border", theme.border);
    root.style.setProperty("--gradient", theme.gradient);
    root.style.setProperty("--gradient-secondary", theme.gradientSecondary);
    root.style.setProperty("--header-bg", theme.headerBg);
    root.style.setProperty("--card-bg", theme.cardBg);
    root.style.setProperty("--input-bg", theme.inputBg);
    root.style.setProperty("--shadow-color", theme.shadow);

    // Add theme class to body for additional styling hooks
    document.body.className = document.body.className
      .split(" ")
      .filter(
        (c) =>
          !c.startsWith("theme-") && c !== "light-mode" && c !== "dark-mode",
      )
      .join(" ");
    document.body.classList.add(`theme-${theme.id}`);
    document.body.classList.add(theme.isLight ? "light-mode" : "dark-mode");
  }
}
