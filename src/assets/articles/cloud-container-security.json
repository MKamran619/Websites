{
  "id": "cloud-container-security",
  "title": "Container Security: From Build to Runtime",
  "excerpt": "Implement defense-in-depth security for containerized applications covering image scanning, runtime protection, and Kubernetes security.",
  "date": "Jul 2023",
  "category": "Cloud Computing",
  "readTime": 13,
  "icon": "☁️",
  "tags": ["Containers", "Security", "Docker", "Kubernetes"],
  "featured": false,
  "author": {
    "name": "Kamran Sohail",
    "role": "Software Engineer & Consultant",
    "avatar": "KS"
  },
  "content": "<h2>The Container Security Challenge</h2><p>Containers introduce new attack surfaces that traditional security tools don't address. A defense-in-depth approach is essential.</p><h2>Build-Time Security</h2><h3>Secure Base Images</h3><ul><li>Use minimal base images (Alpine, Distroless)</li><li>Pin image versions, never use :latest</li><li>Use official images from trusted registries</li></ul><pre><code># Bad\nFROM node:latest\n\n# Good\nFROM node:20.10.0-alpine3.18</code></pre><h3>Image Scanning</h3><p>Scan for vulnerabilities in CI/CD:</p><pre><code># Trivy scan\ntrivy image myapp:v1.0.0\n\n# Snyk scan\nsnyk container test myapp:v1.0.0</code></pre><h3>Dockerfile Best Practices</h3><pre><code>FROM node:20-alpine AS builder\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nRUN npm run build\n\nFROM node:20-alpine\nRUN addgroup -g 1001 -S nodejs && adduser -S nodejs -u 1001\nWORKDIR /app\nCOPY --from=builder --chown=nodejs:nodejs /app/dist ./dist\nCOPY --from=builder --chown=nodejs:nodejs /app/node_modules ./node_modules\nUSER nodejs\nEXPOSE 3000\nCMD [\"node\", \"dist/main.js\"]</code></pre><h2>Registry Security</h2><ul><li>Use private registries with authentication</li><li>Enable vulnerability scanning in registry</li><li>Implement image signing (Cosign, Notary)</li><li>Set up admission policies to enforce signed images</li></ul><pre><code># Sign with Cosign\ncosign sign --key cosign.key myregistry.io/myapp:v1.0.0\n\n# Verify signature\ncosign verify --key cosign.pub myregistry.io/myapp:v1.0.0</code></pre><h2>Runtime Security</h2><h3>Pod Security Standards</h3><pre><code>apiVersion: v1\nkind: Pod\nmetadata:\n  name: secure-pod\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1001\n    fsGroup: 1001\n  containers:\n  - name: app\n    securityContext:\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n      capabilities:\n        drop: [\"ALL\"]</code></pre><h3>Network Policies</h3><pre><code>apiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: deny-all\nspec:\n  podSelector: {}\n  policyTypes:\n  - Ingress\n  - Egress</code></pre><h3>Runtime Monitoring</h3><p>Use tools like Falco for runtime threat detection:</p><pre><code>- rule: Terminal shell in container\n  desc: Detect shell opened in container\n  condition: >\n    spawned_process and container and\n    shell_procs and proc.tty != 0\n  output: Shell opened (user=%user.name container=%container.name)\n  priority: WARNING</code></pre><h2>Secrets Management</h2><ul><li>Never bake secrets into images</li><li>Use Kubernetes Secrets (encrypted at rest)</li><li>Consider external secret stores (Vault, AWS Secrets Manager)</li></ul><pre><code>apiVersion: secrets-store.csi.x-k8s.io/v1\nkind: SecretProviderClass\nmetadata:\n  name: vault-secrets\nspec:\n  provider: vault\n  parameters:\n    vaultAddress: \"https://vault.example.com\"\n    roleName: \"myapp\"\n    objects: |\n      - objectName: \"db-password\"\n        secretPath: \"secret/data/myapp\"\n        secretKey: \"password\"</code></pre><h2>Security Checklist</h2><ul><li>☐ Minimal base images</li><li>☐ Image vulnerability scanning</li><li>☐ Image signing</li><li>☐ Non-root containers</li><li>☐ Read-only root filesystem</li><li>☐ Network policies</li><li>☐ Runtime monitoring</li><li>☐ External secrets management</li></ul><h2>Conclusion</h2><p>Container security requires a layered approach across build, deploy, and runtime phases. Automate security checks in your pipeline and monitor continuously in production.</p>"
}
